<!DOCTYPE  html>
<html>
  <head>
    <meta charset="utf-8">
    
    <title>doc</title>
    <style>
      /*github.com style (c) Vasily Polovnyov <vast@whiteants.net>*/
      pre code {
        display: block; padding: 0.5em;
        color: #333;
        background: #f8f8ff
      }
      pre .comment,
      pre .template_comment,
      pre .diff .header,
      pre .javadoc {
        color: #998;
        font-style: italic
      }
      pre .keyword,
      pre .css .rule .keyword,
      pre .winutils,
      pre .javascript .title,
      pre .nginx .title,
      pre .subst,
      pre .request,
      pre .status {
        color: #333;
        font-weight: bold
      }
      pre .number,
      pre .hexcolor,
      pre .ruby .constant {
        color: #099;
      }
      pre .string,
      pre .tag .value,
      pre .phpdoc,
      pre .tex .formula {
        color: #d14
      }
      pre .title,
      pre .id {
        color: #900;
        font-weight: bold
      }
      pre .javascript .title,
      pre .lisp .title,
      pre .clojure .title,
      pre .subst {
        font-weight: normal
      }
      pre .class .title,
      pre .haskell .type,
      pre .vhdl .literal,
      pre .tex .command {
        color: #458;
        font-weight: bold
      }
      pre .tag,
      pre .tag .title,
      pre .rules .property,
      pre .django .tag .keyword {
        color: #000080;
        font-weight: normal
      }
      pre .attribute,
      pre .variable,
      pre .lisp .body {
        color: #008080
      }
      pre .regexp {
        color: #009926
      }
      pre .class {
        color: #458;
        font-weight: bold
      }
      pre .symbol,
      pre .ruby .symbol .string,
      pre .lisp .keyword,
      pre .tex .special,
      pre .prompt {
        color: #990073
      }
      pre .built_in,
      pre .lisp .title,
      pre .clojure .built_in {
        color: #0086b3
      }
      pre .preprocessor,
      pre .pi,
      pre .doctype,
      pre .shebang,
      pre .cdata {
        color: #999;
        font-weight: bold
      }
      pre .deletion {
        background: #fdd
      }
      pre .addition {
        background: #dfd
      }
      pre .diff .change {
        background: #0086b3
      }
      pre .chunk {
        color: #aaa
      }
    </style>
  </head>
  <body>  
    <p><a href="./index.html">Back to Index</a></p>
<h2 id="apis">APIs</h2>
<h3 id="refresh-ui-of-whole-component">Refresh UI of whole component</h3>
<pre><code>webPivotTable.refreshUI();

    /** 
    * Refresh UI of whole component. 
    * 
    * This is a method to refresh UI after you changed some internal data structure
    * through APIs. 
    * Most of setting APIs, like changeLocale, setOptions, setCsvUrl, etc. 
    * will call this internally, you don&#39;t need call it again.
    */
</code></pre><h3 id="change-language-locale">Change language locale</h3>
<pre><code>webPivotTable.changeLocale(locale);

    /** 
    * Change language locale.
    * @param {string} locale - language locale string
    *      available values: &#39;en&#39;,&#39;zh&#39;,&#39;es&#39;,&#39;pt&#39;,â€˜fr&#39;,&#39;de&#39;,&#39;ar&#39;,&#39;ru&#39;,&#39;it&#39;,
    *                        &#39;nl&#39;,&#39;el&#39;,&#39;he&#39;,&#39;hi&#39;,&#39;hu&#39;,&#39;sv&#39;,&#39;ko&#39;,&#39;ja&#39;
    * 
    * if locale is null, will set locale to webPivotTable.options.locale
    * changeLocale() will call refreshUI automatically. 
    */
</code></pre><h3 id="set-customize-options-after-webpivottable-had-been-created">Set customize options after webPivotTable had been created</h3>
<pre><code>webPivotTable.setOptions(customizeOptions);

    /** 
    * Set customize options after webPivotTable had been created
    * @param {Object} customizeOptions - customize options 
    * 
    * Note:
    * 1. to set customize options while create WebPivotTable object, use
    *       var customizeOptions = {
    *           uiFlags: {
    *              openWptBtn: 0,
    *              saveWptBtn: 0
    *           }
    *       };
    *
    *       var webPivotTable = new WebPivotTable({
    *           customOptions:customizeOptions
    *       },&quot;wpt-container&quot;); 
    * 2. You don&#39;t need pass options which you accept the default value in parameter.
    * 3. setOptions will call refreshUI automatically
    */
</code></pre><h3 id="load-source-data-from-data-array">Load source data from data array</h3>
<pre><code>webPivotTable.setDataArray(attrArray, dataArray, dataUrl, wptObject, successCB, errorCB);

    /**
     * Load source data from data array
     * @param {Array} attrArray - Array of attributes
     *       example: [&quot;department&quot;, &quot;area&quot;, &quot;cost&quot;, ...]
     * @param {Array} dataArray - Array of data rows, each row is also an array of values
     *       example: [[&quot;dep1&quot;, &quot;area1&quot;, 1000, ...], ..., [&quot;dep6&quot;, &quot;area2&quot;, 2000,...]]
     * @param {String} dataUrl - optional, Url for track the source data
     *       This is just for tracking, pass &quot;&quot; if not know or no need.
     * @param {Object} wptObject - optional, pre-saved wpt JSON object
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * Note:
     * 1. If wptObject is not null, use it as pre-saved pivot selections
     * 2. This is major API to load source data into WPT component, it was
     *   used by setCsvUrl and setCsvRawData internally.  Actually, developers
     *   can load any kinds of data from any other resources, like SQL databases,
     *   and format them as attrArray and dataArray, then load them into WPT component.
     */
</code></pre><h3 id="load-multiple-data-sources-together-from-data-arrays">Load multiple data sources together from data arrays</h3>
<pre><code>webPivotTable.setDataArrays (dataSources, wptObject, successCB, errorCB);

    /**
     * Load data from data sources
     * @param {Array} dataSources - Array of data source
     *       example: [{
     *          attr: [&quot;department&quot;, &quot;area&quot;, &quot;cost&quot;, ...],
     *          data: [[&quot;dep1&quot;, &quot;area1&quot;, 1000, ...], ..., [&quot;dep6&quot;, &quot;area2&quot;, 2000,...]],
     *          url: &#39;&#39;
     *       },{
     *          attr: [&quot;department&quot;, &quot;area&quot;, &quot;cost&quot;, ...],
     *          data: [[&quot;dep1&quot;, &quot;area1&quot;, 1000, ...], ..., [&quot;dep6&quot;, &quot;area2&quot;, 2000,...]],
     *          url: &#39;&#39;
     *       }]
     * @param {Object} wptObject - optional, pre-saved wpt JSON object
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * Note:
     * 1. If wptObject is not null, use it as pre-saved pivot selections
     * 2. This is major API to load multiple source data into WPT component, developers
     *   can load any kinds of data from any other resources, like SQL databases,
     *   and format them as attrArray and dataArray, then load them into WPT component.
     */
</code></pre><h3 id="load-source-data-from-csv-file-url">Load source data from CSV file URL</h3>
<pre><code>webPivotTable.setCsvUrl(url, separator, wptObject, successCB, errorCB);

    /**
     * Load source data from CSV file URL
     * @param {string} csvUrl - URL String of CSV file
     * @param {string} separator - optional, separator char for CSV file, default is &quot;,&quot;
     * @param {Object} wptObject - optional, pre-saved wpt JSON object
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * if wptObject is not null, use it as pivot selections
     */
</code></pre><h3 id="load-source-data-from-csv-raw-data">Load source data from CSV RAW data</h3>
<pre><code>webPivotTable.setCsvRawData(csvRawData, separator, wptObject, successCB, errorCB);

    /**
     * Load source data from CSV RAW data
     * @param {string} csvRawData - CSV RAW data
     *    https://dojotoolkit.org/reference-guide/1.9/dojox/data/CsvStore.html
     * @param {string} separator - optional, separator char for CSV RAW data, default is &quot;,&quot;
     * @param {Object} wptObject - optional, pre-saved wpt JSON object
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * if wptObject is not null, use it as pivot selections
     */
</code></pre><p>WPT component use
<a href="https://dojotoolkit.org/reference-guide/1.9/dojox/data/CsvStore.html" target="_blank">dojox.data.CsvStore</a>
to handle CSV RAW data, please reference that to under CSV RAW data.</p>
<h3 id="load-source-data-from-web-service-data-url">Load source data from Web Service Data URL</h3>
<pre><code>webPivotTable.setWebServiceDataUrl(wsDataUrl, wptObject, successCB, errorCB);

    /**
     * Load source data from Web Service Data URL
     * @param {string} wsDataUrl - URL String of Web Service Data URL
     * @param {Object} wptObject - optional, pre-saved wpt JSON object
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     *
     * Note:
     * 1. The Web Service should return a JSON object
     *       {
     *           attrArray: [],
     *           dataArray: []
     *       }
     * 2. This is a very useful API to access data in SQL databases or any other data storages
     *    since Web Service access is cross domain and can be provided by any backend technologies.
     * 3. If wptObject is not null, use it as pivot selections
     */
</code></pre><h3 id="load-wpt-format-object-from-web-service-wpt-url">Load WPT format object from Web Service WPT URL</h3>
<pre><code>webPivotTable.setWebServiceWptUrl(wsWptUrl, dataObject, successCB, errorCB);

    /**
     * Load WPT format object from Web Service WPT URL
     * @param {string} wsWptUrl - URL String of Web Service WPT URL
     * @param {Object} dataObject - optional, if exist, use this as data and fields of first source
     *        format {data:[], fields:[]}
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     *
     * Note:
     * 1. The Web Service should return a WPT format JSON object
     *       {
     *           format: &quot;WPT&quot;,
     *           version: &quot;2.0&quot;,
     *           sources: [],
     *           sheets: [],
     *           reprots: []
     *       }
     * 2. This is a very useful API to load WPT from SQL databases or any other data storages
     *    since Web Service access is cross domain and can be provided by any backend technologies.
     */
</code></pre><h3 id="load-wpt-format-string">Load WPT format String</h3>
<pre><code>webPivotTable.setWptString(wptString, dataObject, successCB, errorCB);

    /**
     * Load WPT format String
     * @param {String} wptString - pre-saved WPT format string
     * @param {Object} dataObject - optional, if exist, use this as data and fields of first source
     *        format {data:[], fields:[]}
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="load-wpt-format-json-oject">Load WPT format JSON Oject</h3>
<pre><code>webPivotTable.setWptObject(wptObject, dataObject, successCB, errorCB);

    /**
     * Load WPT format JSON Oject
     * @param {Object} wptObject - pre-saved WPT format JSON object
     * @param {Object} dataObject - optional, if exist, use this as data and fields of first source
     *        format {data:[], fields:[]}
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="load-wpt-format-string-or-json-oject-with-updated-first-source-data">Load WPT format String or JSON Oject with updated first source data</h3>
<pre><code>webPivotTable.setWpt(wpt, dataObject, successCB, errorCB);

    /**
     * Load WPT format String or JSON Oject with updated first source data
     * @param {String/Object} wpt - pre-saved WPT format String or JSON object
     * @param {Object} dataObject - optional, if exist, use this as data and fields of first source
     *        format {data:[], fields:[]}
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="load-wpt-format-string-or-json-object-with-data-array-as-updated-first-source-data">Load WPT format String or JSON object with data array as updated first source data</h3>
<pre><code>webPivotTable.setWptWithDataArray(wpt, attrArray, dataArray, successCB, errorCB);

    /**
     * Load WPT format String or JSON object with data array as updated first source data
     * @param {String/Object} wpt - pre-saved WPT format String or JSON object
     * @param {Array} attrArray - Array of attributes
     *       example: [&quot;department&quot;, &quot;area&quot;, &quot;cost&quot;, ...]
     * @param {Array} dataArray - Array of data rows, each row is also an array of values
     *       example: [[&quot;dep1&quot;, &quot;area1&quot;, 1000, ...], ..., [&quot;dep6&quot;, &quot;area2&quot;, 2000,...]]
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="load-wpt-format-string-or-json-oject-with-updated-first-source-data">Load WPT format String or JSON Oject with updated first source data</h3>
<pre><code>webPivotTable.setWptWithCsvUrl(wpt, csvUrl, separator, successCB, errorCB);

    /**
     * Load WPT format String or JSON object with CSV Url as updated first source data
     * @param {String/Object} wpt - pre-saved WPT format String or JSON object
     * @param {string} csvUrl - URL String of CSV file
     * @param {string} separator - optional, separator char for CSV RAW data, default is &quot;,&quot;
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="load-wpt-format-string-or-json-object-with-csv-raw-data-as-updated-first-source-data">Load WPT format String or JSON object with CSV RAW data as updated first source data</h3>
<pre><code>webPivotTable.setWptWithCsvRawData(wpt, csvRawData, separator, successCB, errorCB);

    /**
     * Load WPT format String or JSON object with CSV RAW data as updated first source data
     * @param {String/Object} wpt - pre-saved WPT format String or JSON object
     * @param {String} csvRawData - CSV RAW data
     *    https://dojotoolkit.org/reference-guide/1.9/dojox/data/CsvStore.html
     * @param {string} separator - optional, separator char for CSV RAW data, default is &quot;,&quot;
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="load-olap-cube">Load OLAP Cube</h3>
<pre><code>webPivotTable.setOlapCube(olapData, successCB, errorCB);

    /**
     * Load OLAP Cube
     * @param {Object} olapData - Object of OLAP Cube Information
     *     {
     *         options: {
     *             sync : _this.options.olap.sync,
     *             timeout : _this.options.olap.timeout,
     *             xmlaProxyEnabled: _this.options.olap.xmlaProxyEnabled,
     *             xmlaProxy: _this.options.olap.xmlaProxy
     *         },
     *         xmlaUrl: &quot;Xmla server url&quot;,
     *         DataSourceInfo: &quot;Data source info&quot;,
     *         Catalog: &quot;Catalog name&quot;,
     *         CubeName: &quot;Cube name&quot;
     *     }
     * @param {Func} successCB(wpt) - optional, success callback
     *        in this callback, current wpt object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     *
     * @param {Func} errorCB(error) - optional, error callback
     *        in this callback, error object will be published as first parameter
     *        and &quot;this&quot; will be WebPivotTable object
     */
</code></pre><h3 id="get-internal-wpt-object">Get internal WPT object</h3>
<pre><code>var wpt = webPivotTable.getWptObject();

    /**
     * get internal WPT object
     * 
     * This will return current WPT internal object, developers can change anything directly 
     * in this object, for example, change sources/sheets name or fields. 
     * After changed this object, call refreshUI to refresh whole UI.
     * 
     * Please follow wpt-file-format document to understand returned object:
     *   http://webpivottable.com/documents/wpt-file-format
     *
     * @return {object}
     */
</code></pre><h3 id="generate-wpt-format-string">Generate WPT format string</h3>
<pre><code>var wptString = webPivotTable.generateWptString(ignoreData);

    /** 
    * Generate WPT format string to be saved into wpt file.
    * @param {boolean} ignoreData 
    *        if equal to true, ignore data and fields, only save options and controls
    * @return {string} 
    */
</code></pre><h3 id="generate-wpt-format-json-object">Generate WPT format JSON object</h3>
<pre><code>var wptObject = webPivotTable.generateWptJSON(ignoreData);

    /** 
    * Generate WPT format JSON object
    * @param {boolean} ignoreData 
    *        if equal to true, ignore data and fields, only save options and controls
    * @return {Object} 
    */
</code></pre><h3 id="generate-wpt-string-from-data-array-with-default-options-and-controls">Generate wpt string from data array with default options and controls</h3>
<pre><code>webPivotTable.generateWptStringFromDataArray(attrArray, dataArray, dataUrl, callback, errCallback);

    /** 
    * Generate wpt string from data array with default options and controls
    * @param {Array} attrArray - Array of attributes
    *       example: [&quot;department&quot;, &quot;area&quot;, &quot;cost&quot;, ...]
    * @param {Array} dataArray - Array of data rows, each row is also an array of values
    *       example: [[&quot;dep1&quot;, &quot;area1&quot;, 1000, ...], ..., [&quot;dep6&quot;, &quot;area2&quot;, 2000,...]]
    * @param {String} dataUrl - optional, Url for track the source data
    *       This is just for tracking, pass &quot;&quot; if not know or no need. 
    * @param {Function} callback - Callback function when success
    *           callback = function(wptString)
    * @param {Function} errCallback - Callback function when error
    *           errCallback = function(error)
    */
</code></pre><h3 id="generate-wpt-string-from-csv-url-with-default-options-and-controls">Generate wpt string from Csv Url with default options and controls</h3>
<pre><code>webPivotTable.generateWptStringFromCsvUrl(csvUrl, separator, callback, errCallback);

    /** 
    * Generate wpt string from Csv Url with default options and controls
    * @param {string} csvUrl - URL String of CSV file
    * @param {string} separator - optional, separator char for CSV RAW data, default is &quot;,&quot;
    * @param {Function} callback - Callback function when success
    *           callback = function(wptString)
    * @param {Function} errCallback - Callback function when error
    *           errCallback = function(error)
    */
</code></pre><h3 id="generate-wpt-string-from-csv-raw-data-with-default-options-and-controls">Generate wpt string from Csv RAW data with default options and controls</h3>
<pre><code>webPivotTable.generateWptStringFromCsvRawData(csvRawData, separator, callback, errCallback);

    /** 
    * Generate wpt string from Csv RAW data with default options and controls
    * @param {String} csvRawData - CSV RAW data
    *    https://dojotoolkit.org/reference-guide/1.9/dojox/data/CsvStore.html
    * @param {string} separator - optional, separator char for CSV RAW data, default is &quot;,&quot;
    * @param {Function} callback - Callback function when success
    *           callback = function(wptString)
    * @param {Function} errCallback - Callback function when error
    *           errCallback = function(error)
    */
</code></pre><h3 id="retrieve-current-filtered-data-for-a-sheet">Retrieve current filtered data for a sheet</h3>
<pre><code>webPivotTable.generateFilteredData(sheetIndex);

    /**
     * Generate current filtered data for a sheet
     * @param {int} sheetIndex - sheet index
     * @return {Object}
     *      {
     *         attrArray: [&quot;department&quot;, &quot;area&quot;, &quot;cost&quot;, ...]
     *         dataArray: [[&quot;dep1&quot;, &quot;area1&quot;, 1000, ...], ..., [&quot;dep6&quot;, &quot;area2&quot;, 2000,...]]
     *      }
     */
</code></pre>
  </body>
</html>
